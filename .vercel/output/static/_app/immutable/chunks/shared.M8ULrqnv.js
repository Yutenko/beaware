import{t as o}from"./types.18TL9lEU.js";const a={ADD_CONTAINER:"add-container",REMOVE_CONTAINER:"remove-container",RESET_CONTAINER:"reset-container",ADD_ELEMENT:"add-element",REMOVE_ELEMENT:"remove-element",UPDATE_PARENT:"update-parent",INITIAL_DATA:"initial-data",START:"start",FINISHED:"finished"},t={receiver:{init:e=>{if(e&&Object.keys(e).length>0){const{addContainer:d,removeContainer:i,resetContainer:E,addElement:c,removeElement:s,updateParent:r,initalData:m}=e;t.receiver._updateFn=r,window.addEventListener("message",function(N){if(N.data){let n=JSON.parse(N.data);if(n.cmd===a.ADD_CONTAINER)d(n.data);else if(n.cmd===a.REMOVE_CONTAINER)i(n.data);else if(n.cmd===a.RESET_CONTAINER)E(n.data);else if(n.cmd===a.ADD_ELEMENT)c(n.data);else if(n.cmd===a.REMOVE_ELEMENT)s(n.data);else if(n.cmd===a.UPDATE_PARENT)return t.receiver.updateParent();t.receiver.updateParent()}}),m&&t.receiver._send({cmd:a.INITIAL_DATA,data:JSON.stringify(m)})}},updateParent:()=>{t.receiver._updateFn&&t.receiver._send({cmd:a.UPDATE_PARENT,data:t.receiver._updateFn()})},start:e=>{t.receiver._send({cmd:a.START,data:e})},finished:e=>{t.receiver._send({cmd:a.FINISHED,data:e})},_send:e=>{window.parent.postMessage(JSON.stringify(e),"*")},_updateFn:null},sender:{init:e=>{{const{onUpdate:d,onInitalData:i,onStart:E,onFinished:c}=e;window.addEventListener("message",function(s){if(s.data){let r=JSON.parse(s.data);r.cmd===a.UPDATE_PARENT?d(JSON.parse(r.data)):r.cmd===a.INITIAL_DATA?i(JSON.parse(r.data)):r.cmd===a.START?E():r.cmd===a.FINISHED&&c(r.data)}})}},_send:e=>{document.querySelector('iframe[data-is-quiz-receiver="true"]').contentWindow.postMessage(JSON.stringify(e),"*")},api:{addContainer:()=>{t.sender._send({cmd:a.ADD_CONTAINER})},removeContainer:e=>{t.sender._send({cmd:a.REMOVE_CONTAINER,data:e})},resetContainer:e=>{t.sender._send({cmd:a.RESET_CONTAINER,data:e})},updateParent:()=>{t.sender._send({cmd:a.UPDATE_PARENT})}}},shuffle:e=>d=>d.sort(()=>.5-Math.random())};function A(e,d){return e===o.groupassignment?d.map(i=>({id:i.id,points:i.solved?1:0,attempts:i.timesAssigned})):d}export{t as Q,A as e};
